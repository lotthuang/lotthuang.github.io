<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>概述 - Lott's Blog</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "\u6982\u8ff0";
    var mkdocs_page_input_path = "chapter_9/1_sar_cmd.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Lott's Blog</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">首页</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">第一章 常用软件</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../chapter_1/1_make_blog/">第一篇 利用Github Pages和mkdocs搭建个人博客</a>
                </li>
                <li class="">
                    
    <a class="" href="../../chapter_1/2_nginx_loadbalancing_strategy/">第二篇 Nginx的均衡策略</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">第二章 运维工作总结</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../chapter_2/yunweijiazhi/">第一篇 运维的价值和目标</a>
                </li>
                <li class="">
                    
    <a class="" href="../../chapter_2/yunweizhiyeguifan/">第二篇 业务SRE的职业规范</a>
                </li>
                <li class="">
                    
    <a class="" href="../../chapter_2/yunweipingtailinian/">第三篇 运维平台建设的理念</a>
                </li>
                <li class="">
                    
    <a class="" href="../../chapter_2/guzhangguanli/">第四篇 故障管理概述</a>
                </li>
                <li class="">
                    
    <a class="" href="../../chapter_2/biangengguanli/">第五篇 变更管理概述</a>
                </li>
                <li class="">
                    
    <a class="" href="../../chapter_2/rongliangguanli/">第六篇 容量管理概述</a>
                </li>
                <li class="">
                    
    <a class="" href="../../chapter_2/jiagoushisiweihetezhi/">第七篇 架构师思维和特质以及中间件技术梳理</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">第三章 Linux Net子系统</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../chapter_3/1_linux_kernel_net/">第一篇 Linux数据包接收路径梳理和常用调优技能</a>
                </li>
                <li class="">
                    
    <a class="" href="../../chapter_3/2_estab_queue_monitoring/">第二篇 Linux下如何观察完整连接队列的情况</a>
                </li>
                <li class="">
                    
    <a class="" href="../../chapter_3/3_net_ipv4_tcp_syn_retries/">第三篇 理解net.ipv4.tcp_syn_retries设置</a>
                </li>
                <li class="">
                    
    <a class="" href="../../chapter_3/4_linux_kernel_net_v2/">第四篇 Linux网络数据包的揭秘以及常见的调优方式总结</a>
                </li>
                <li class="">
                    
    <a class="" href="../../chapter_3/5_conntrack/">第五篇 conntrack的常见应用</a>
                </li>
                <li class="">
                    
    <a class="" href="../../chapter_3/6_tcp/">第六篇 TCP协议总结</a>
                </li>
                <li class="">
                    
    <a class="" href="../../chapter_3/7_udp/">第七篇 UDP协议总结以及TCP和UDP的区别</a>
                </li>
                <li class="">
                    
    <a class="" href="../../chapter_3/8_io_multiplexing/">第八篇 IO多路复用总结</a>
                </li>
                <li class="">
                    
    <a class="" href="../../daibuchong/">第九篇 Linux内核协议栈总结</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">第四章 Linux CPU子系统</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../chapter_4/1_process_ulimit/">第一篇 进程Max open files的设置</a>
                </li>
                <li class="">
                    
    <a class="" href="../../chapter_4/2_pid_max/">第二篇 kernel源码中pid的最大值</a>
                </li>
                <li class="">
                    
    <a class="" href="../../chapter_4/3_interrupt_one/">第三篇 硬中断</a>
                </li>
                <li class="">
                    
    <a class="" href="../../daibuchong/">第四篇 软中断</a>
                </li>
                <li class="">
                    
    <a class="" href="../../chapter_4/4_process_thread_coroutine/">第五篇 进程、线程、协程</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">第五章 Linux IO子系统</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../chapter_5/1_four_object_of_VFS/">第一篇 VFS四大对象inode、dentry、super_block、file数据结构总结</a>
                </li>
                <li class="">
                    
    <a class="" href="../../daibuchong/">第二篇 Linux IO栈总结</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">第六章 Linux Mem子系统</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../chapter_6/1_linux_buddy/">第一篇 伙伴系统介绍</a>
                </li>
                <li class="">
                    
    <a class="" href="../../daibuchong/">第二篇 Slab层介绍</a>
                </li>
                <li class="">
                    
    <a class="" href="../../daibuchong/">第三篇 进程虚拟地址空间介绍</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">第七章 运维小技巧和工具汇总和积累</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../chapter_7/1_sync_file/">第一篇 不同主机之间的文件传输</a>
                </li>
                <li class="">
                    
    <a class="" href="../../chapter_7/2_sre_tools_python/">第二篇 运维生产力工具(python篇)</a>
                </li>
                <li class="">
                    
    <a class="" href="../../chapter_7/3_sre_tools_website/">第三篇 运维生产力工具(网站工具)</a>
                </li>
                <li class="">
                    
    <a class="" href="../../chapter_7/4_sre_tools_shell/">第四篇 运维生产力工具(shell篇)</a>
                </li>
                <li class="">
                    
    <a class="" href="../../chapter_7/5_server_side_evolution/">第五篇 服务端进化过程梳理</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">第八章 职场通用经验</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../chapter_8/1_xuexixinde/">第一篇 个人学习心得总结</a>
                </li>
                <li class="">
                    
    <a class="" href="../../chapter_8/2_bangzhuqitatongxue/">第二篇 如何帮助其他同学提升技术能力</a>
                </li>
                <li class="">
                    
    <a class="" href="../../chapter_8/3_yewuliuchengshuyu/">第三篇 业务流程术语梳理</a>
                </li>
                <li class="">
                    
    <a class="" href="../../chapter_8/4_jishunenglimoxing/">第四篇 技术能力模型总结</a>
                </li>
                <li class="">
                    
    <a class="" href="../../chapter_8/5_chanpingsiwei_1/">第五篇 产品思维总结和梳理</a>
                </li>
                <li class="">
                    
    <a class="" href="../../chapter_8/6_jixiaobaogao/">第六篇 如何写绩效报告</a>
                </li>
                <li class="">
                    
    <a class="" href="../../chapter_8/7_xiangshangguanli/">第七篇 如何向上管理</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">第九章 Linux性能观察工具</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../daibuchong/">第一篇 sar命令使用总结</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Lott's Blog</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
    
    <li>概述</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="_1">概述</h1>
<ul>
<li>本篇总结一下<code>sar</code>命令的作用、常见的使用方法</li>
<li><code>sar</code>工具本身是搜集、报告或者存储系统活动的<a href="https://manpages.debian.org/testing/sysstat/sar.sysstat.1.en.html">工具</a>.</li>
</ul>
<h2 id="_2">语法</h2>
<pre><code>sar(选项)(参数)
sar [options] [-A] [-o file] t [n]
</code></pre>

<p>其中：</p>
<ul>
<li>options 为命令行选项，t为采样间隔，n为采样次数，默认值是1 </li>
<li>-o file表示将命令结果以二进制格式存放在文件中，file 是文件名。</li>
</ul>
<h2 id="_3">选项</h2>
<pre><code>-A：显示所有的报告信息；
-b：显示I/O速率；
-B：显示换页状态；
-c：显示进程创建活动；
-d：显示每个块设备的状态；
-e：设置显示报告的结束时间；
-f：从指定文件提取报告；
-i：设状态信息刷新的间隔时间；
-P：报告每个CPU的状态；
-R：显示内存状态；
-u：显示CPU利用率；
-v：显示索引节点，文件和其他内核表的状态；
-w：显示交换分区状态；
-x：显示给定进程的状态。
</code></pre>

<p>1.
2.
3.
4.
5.
6.
7.
8.
9.
10.
11.
12.
13.
14.
参数
间隔时间：每次报告的间隔时间（秒）；
次数：显示报告的次数。
1.
2.</p>
<h2 id="_4">实例</h2>
<h3 id="1cpu">1、CPU资源监控：</h3>
<ul>
<li>每5s采样一次，连续采样3次，观察cpu使用情况，并将采样结果以二进制形式存入test_sar中（查看二进制文件test中的内容，sar命令：sar -u -f test_sar）</li>
</ul>
<p>1.
[root@zabbix_nuc ~]# sar -u -o test_sar 5 3
Linux 3.10.0-693.17.1.el7.x86_64 (zabbix_nuc)   2018年03月29日     <em>x86_64</em>    (4 CPU)</p>
<p>10时28分24秒     CPU     %user     %nice   %system   %iowait    %steal     %idle
10时28分29秒     all      0.20      0.00      0.10      0.00      0.00     99.70
10时28分34秒     all      0.10      0.00      0.20      0.00      0.00     99.70
10时28分39秒     all      0.20      0.00      0.10      0.00      0.00     99.70
平均时间:        all      0.17      0.00      0.13      0.00      0.00     99.70</p>
<ul>
<li>输出项说明：</li>
</ul>
<pre><code>CPU：all表示统计信息为所有 CPU的平均值。

%user：显示在用户级别(application)运行使用 CPU总时间的百分比。

%nice：显示在用户级别，用于nice操作，所占用 CPU总时间的百分比。

%system：在核心级别(kernel)运行所使用 CPU总时间的百分比。

%iowait：显示用于等待I/O操作占用 CPU总时间的百分比。

%steal：管理程序(hypervisor)为另一个虚拟进程提供服务而等待虚拟CPU 的百分比。

%idle：显示 CPU空闲时间占用 CPU总时间的百分比。

</code></pre>

<p>P.S：
1.若 %iowait的值过高，表示硬盘存在I/O瓶颈</p>
<p>2.若 %idle的值高但系统响应慢时，有可能是CPU等待分配内存，此时应加大内存容量</p>
<p>3.若 %idle的值持续低于1，则系统的CPU处理能力相对较低，表明系统中最需要解决的资源是 CPU。</p>
<p>2、inode、文件和其他内核表监控：
每5秒采样一次，连续采样10次，观察核心表的状态
1.
[root@zabbix_nuc ~]# sar -v 5 10
Linux 3.10.0-693.17.1.el7.x86_64 (zabbix_nuc)   2018年03月29日     <em>x86_64</em>    (4 CPU)</p>
<p>10时32分43秒 dentunusd   file-nr  inode-nr    pty-nr
10时32分48秒    226121      1664     86294         1
10时32分53秒    226121      1664     86294         1
10时32分58秒    226121      1664     86294         1
10时33分03秒    226118      1664     86290         1
10时33分08秒    226118      1664     86291         1
10时33分13秒    226126      1664     86300         1
10时33分18秒    226126      1664     86298         1
10时33分23秒    226126      1632     86298         1
10时33分28秒    226126      1664     86299         1
10时33分33秒    226126      1664     86298         1
平均时间:       226123      1661     86296         1
[root@zabbix_nuc ~]#
1.
2.
3.
4.
5.
6.
7.
8.
9.
10.
11.
12.
13.
14.
15.
16.
输出项说明：
dentunusd：目录高速缓存中未被使用的条目数量</p>
<p>file-nr：文件句柄（filehandle）的使用数量</p>
<p>inode-nr：索引节点句柄（inodehandle）的使用数量</p>
<p>pty-nr：使用的pty数量
1.
2.
3.
4.
5.
6.
7.
3、内存和交换空间监控：
每5s采样一次，连续采样10次，监控内存分页
1.
[root@zabbix_nuc ~]# sar -r 5 10
Linux 3.10.0-693.17.1.el7.x86_64 (zabbix_nuc)   2018年03月29日     <em>x86_64</em>    (4 CPU)</p>
<p>10时35分23秒 kbmemfree kbmemused  %memused kbbuffers  kbcached  kbcommit   %commit  kbactive   kbinact   kbdirty
10时35分28秒  12430300   3720688     23.04      2288   2536368   2274384      8.54   2861256    439388        20
10时35分33秒  12430636   3720352     23.03      2288   2536368   2274384      8.54   2861288    439388         8
10时35分38秒  12430068   3720920     23.04      2288   2536368   2274384      8.54   2861288    439388         8
10时35分43秒  12430068   3720920     23.04      2288   2536368   2274384      8.54   2861288    439388        12
10时35分48秒  12430440   3720548     23.04      2288   2536368   2274384      8.54   2861288    439388        12
10时35分53秒  12430440   3720548     23.04      2288   2536368   2274384      8.54   2861288    439388        20
10时35分58秒  12430440   3720548     23.04      2288   2536368   2274384      8.54   2861288    439388         8
10时36分03秒  12430440   3720548     23.04      2288   2536368   2274384      8.54   2861288    439388         8
10时36分08秒  12430440   3720548     23.04      2288   2536368   2274384      8.54   2861288    439388         8
10时36分13秒  12430408   3720580     23.04      2288   2536368   2274384      8.54   2861288    439388        20
平均时间:     12430368   3720620     23.04      2288   2536368   2274384      8.54   2861285    439388        12
[root@zabbix_nuc ~]#
1.
2.
3.
4.
5.
6.
7.
8.
9.
10.
11.
12.
13.
14.
15.
16.
输出项说明：
kbmemfree：这个值和free命令中的free值基本一致,所以它不包括buffer和cache的空间.</p>
<p>kbmemused：这个值和free命令中的used值基本一致,所以它包括buffer和cache的空间.</p>
<p>%memused：这个值是kbmemused和内存总量(不包括swap)的一个百分比.</p>
<p>kbbuffers和kbcached：这两个值就是free命令中的buffer和cache.</p>
<p>kbcommit：保证当前系统所需要的内存,即为了确保不溢出而需要的内存(RAM+swap).</p>
<p>%commit：这个值是kbcommit与内存总量(包括swap)的一个百分比.
1.
2.
3.
4.
5.
6.
7.
8.
9.
10.
11.
4、内存分页监控：
每10s采样一次，连续采样3次，监控内存分页
1.
[root@zabbix_nuc ~]# sar -B 10 3
Linux 3.10.0-693.17.1.el7.x86_64 (zabbix_nuc)   2018年03月29日     <em>x86_64</em>    (4 CPU)</p>
<p>12时08分10秒  pgpgin/s pgpgout/s   fault/s  majflt/s  pgfree/s pgscank/s pgscand/s pgsteal/s    %vmeff
12时08分20秒      0.00    754.40     26.20      0.00     35.90      0.00      0.00      0.00      0.00
12时08分30秒      0.00    429.60    172.00      0.00     87.00      0.00      0.00      0.00      0.00
12时08分40秒      0.00    272.40    221.60      0.00     95.60      0.00      0.00      0.00      0.00
平均时间:      0.00    485.47    139.93      0.00     72.83      0.00      0.00      0.00      0.00
[root@zabbix_nuc ~]#
1.
2.
3.
4.
5.
6.
7.
8.
9.
输出项说明：
pgpgin/s：表示每秒从磁盘或SWAP置换到内存的字节数(KB)</p>
<p>pgpgout/s：表示每秒从内存置换到磁盘或SWAP的字节数(KB)</p>
<p>fault/s：每秒钟系统产生的缺页数,即主缺页与次缺页之和(major +minor)</p>
<p>majflt/s：每秒钟产生的主缺页数.</p>
<p>pgfree/s：每秒被放入空闲队列中的页个数</p>
<p>pgscank/s：每秒被kswapd扫描的页个数</p>
<p>pgscand/s：每秒直接被扫描的页个数</p>
<p>pgsteal/s：每秒钟从cache中被清除来满足内存需要的页个数</p>
<p>%vmeff：每秒清除的页(pgsteal)占总扫描页(pgscank+pgscand)的百分比
1.
2.
3.
4.
5.
6.
7.
8.
9.
10.
11.
12.
13.
14.
15.
16.
17.
5、I/O和传送速率监控：
每5s采样一次，连续采样10次，报告缓冲区的使用情况
1.
[root@zabbix_nuc ~]# sar -b 5 10
Linux 3.10.0-693.17.1.el7.x86_64 (zabbix_nuc)   2018年03月29日     <em>x86_64</em>    (4 CPU)</p>
<p>10时40分18秒       tps      rtps      wtps   bread/s   bwrtn/s
10时40分23秒      3.00      0.00      3.00      0.00     28.80
10时40分28秒      4.60      0.00      4.60      0.00     64.00
10时40分33秒      3.20      0.00      3.20      0.00     33.60
10时40分38秒      3.20      0.00      3.20      0.00     36.80
10时40分43秒      2.40      0.00      2.40      0.00     24.00
10时40分48秒      3.60      0.00      3.60      0.00     35.20
10时40分53秒      2.80      0.00      2.80      0.00     32.00
10时40分58秒      3.40      0.00      3.40      0.00     32.00
10时41分03秒      5.60      0.00      5.60      0.00     91.20
10时41分08秒      3.40      0.00      3.40      0.00     35.20
平均时间:         3.52      0.00      3.52      0.00     41.28
[root@zabbix_nuc ~]#
1.
2.
3.
4.
5.
6.
7.
8.
9.
10.
11.
12.
13.
14.
15.
16.
输出项说明：
tps：每秒钟物理设备的 I/O传输总量</p>
<p>rtps：每秒钟从物理设备读入的数据总量</p>
<p>wtps：每秒钟向物理设备写入的数据总量</p>
<p>bread/s：每秒钟从物理设备读入的数据量，单位为块/s</p>
<p>bwrtn/s：每秒钟向物理设备写入的数据量，单位为块/s
1.
2.
3.
4.
5.
6.
7.
8.
9.
6、进程队列长度和平均负载状态监控：
每5s采样一次，连续采样10次，监控进程队列长度和平均负载状态
1.
[root@zabbix_nuc ~]# sar -q 5 10
Linux 3.10.0-693.17.1.el7.x86_64 (zabbix_nuc)   2018年03月29日     <em>x86_64</em>    (4 CPU)</p>
<p>10时42分34秒   runq-sz  plist-sz   ldavg-1   ldavg-5  ldavg-15   blocked
10时42分39秒         0       273      0.06      0.18      0.40         0
10时42分44秒         0       273      0.06      0.18      0.40         0
10时42分49秒         0       273      0.05      0.17      0.40         0
10时42分54秒         0       273      0.05      0.17      0.40         0
10时42分59秒         1       274      0.05      0.17      0.39         0
10时43分04秒         0       274      0.04      0.17      0.39         0
10时43分09秒         0       274      0.04      0.16      0.39         0
10时43分14秒         0       274      0.04      0.16      0.39         0
10时43分19秒         0       272      0.03      0.16      0.39         0
10时43分24秒         0       273      0.03      0.16      0.39         0
平均时间:            0       273      0.04      0.17      0.39         0
[root@zabbix_nuc ~]#
1.
2.
3.
4.
5.
6.
7.
8.
9.
10.
11.
12.
13.
14.
15.
16.
输出项说明：
runq-sz：运行队列的长度（等待运行的进程数）</p>
<p>plist-sz：进程列表中进程（processes）和线程（threads）的数量</p>
<p>ldavg-1：最后1分钟的系统平均负载（Systemload average）</p>
<p>ldavg-5：过去5分钟的系统平均负载</p>
<p>ldavg-15：过去15分钟的系统平均负载
1.
2.
3.
4.
5.
6.
7.
8.
9.
7、系统交换活动信息监控：
每5s采样一次，连续采样10次，监控系统交换活动信息
1.
[root@zabbix_nuc ~]# sar -W 5 10
Linux 3.10.0-693.17.1.el7.x86_64 (zabbix_nuc)   2018年03月29日     <em>x86_64</em>    (4 CPU)</p>
<p>10时44分20秒  pswpin/s pswpout/s
10时44分25秒      0.00      0.00
10时44分30秒      0.00      0.00
10时44分35秒      0.00      0.00
10时44分40秒      0.00      0.00
10时44分45秒      0.00      0.00
10时44分50秒      0.00      0.00
10时44分55秒      0.00      0.00
10时45分00秒      0.00      0.00
10时45分05秒      0.00      0.00
10时45分10秒      0.00      0.00
平均时间:         0.00      0.00
[root@zabbix_nuc ~]#
1.
2.
3.
4.
5.
6.
7.
8.
9.
10.
11.
12.
13.
14.
15.
16.
输出项说明：
pswpin/s：每秒系统换入的交换页面（swap page）数量</p>
<p>pswpout/s：每秒系统换出的交换页面（swap page）数量
1.
2.
3.
8、统计网络信息</p>
<h1 id="sar-n6devedevnfsnfsdsockipeipicmpeicmptcpetcpudpsock6ip6eip6icmp6eicmp6udp6-devedevnfsnfsnfsdnfssockall5">sar -n选项使用6个不同的开关：DEV，EDEV，NFS，NFSD，SOCK，IP，EIP，ICMP，EICMP，TCP，ETCP，UDP，SOCK6，IP6，EIP6，ICMP6，EICMP6和UDP6 ，DEV显示网络接口信息，EDEV显示关于网络错误的统计数据，NFS统计活动的NFS客户端的信息，NFSD统计NFS服务器的信息，SOCK显示套接字信息，ALL显示所有5个开关。它们可以单独或者一起使用。</h1>
<p>1.
8.1、sar -n DEV 1 3
每间隔1秒统计一次，总计统计3次，下面的average是在多次统计后的平均值
1.
[root@zabbix_nuc ~]# sar -n DEV 1 3
Linux 3.10.0-693.17.1.el7.x86_64 (zabbix_nuc)   2018年03月29日     <em>x86_64</em>    (4 CPU)</p>
<p>11时03分48秒     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s
11时03分49秒   enp0s25    103.00    108.00      6.84      7.25      0.00      0.00      0.00
11时03分49秒    wlp2s0      0.00      0.00      0.00      0.00      0.00      0.00      0.00
11时03分49秒        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00</p>
<p>11时03分49秒     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s
11时03分50秒   enp0s25     86.00     94.00      5.72      6.85      0.00      0.00      0.00
11时03分50秒    wlp2s0      0.00      0.00      0.00      0.00      0.00      0.00      0.00
11时03分50秒        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00</p>
<p>11时03分50秒     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s
11时03分51秒   enp0s25    105.00    112.00      6.95      8.01      0.00      0.00      0.00
11时03分51秒    wlp2s0      0.00      0.00      0.00      0.00      0.00      0.00      0.00
11时03分51秒        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00</p>
<p>平均时间:     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s
平均时间:   enp0s25     98.00    104.67      6.50      7.37      0.00      0.00      0.00
平均时间:    wlp2s0      0.00      0.00      0.00      0.00      0.00      0.00      0.00
平均时间:        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00
[root@zabbix_nuc ~]#
1.
2.
3.
4.
5.
6.
7.
8.
9.
10.
11.
12.
13.
14.
15.
16.
17.
18.
19.
20.
21.
22.
23.
输出项说明：</p>
<h1 id="iface">IFACE 本地网卡接口的名称</h1>
<h1 id="rxpcks">rxpck/s 每秒钟接受的数据包</h1>
<h1 id="txpcks">txpck/s 每秒钟发送的数据库</h1>
<h1 id="rxkbs-kb">rxKB/S 每秒钟接受的数据包大小，单位为KB</h1>
<h1 id="txkbs-kb">txKB/S 每秒钟发送的数据包大小，单位为KB</h1>
<h1 id="rxcmps">rxcmp/s 每秒钟接受的压缩数据包</h1>
<h1 id="txcmps">txcmp/s 每秒钟发送的压缩包</h1>
<h1 id="rxmcsts">rxmcst/s 每秒钟接收的多播数据包</h1>
<p>1.
2.
3.
4.
5.
6.
7.
8.
9.
10.
11.
12.
13.
14.
15.
8.2、sar -n EDEV 1 1 #统计网络设备通信失败信息：
[root@zabbix_nuc ~]# sar -n EDEV  1 1
Linux 3.10.0-693.17.1.el7.x86_64 (zabbix_nuc)   2018年03月29日     <em>x86_64</em>    (4 CPU)</p>
<p>11时07分21秒     IFACE   rxerr/s   txerr/s    coll/s  rxdrop/s  txdrop/s  txcarr/s  rxfram/s  rxfifo/s  txfifo/s
11时07分22秒   enp0s25      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
11时07分22秒    wlp2s0      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
11时07分22秒        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00</p>
<p>平均时间:     IFACE   rxerr/s   txerr/s    coll/s  rxdrop/s  txdrop/s  txcarr/s  rxfram/s  rxfifo/s  txfifo/s
平均时间:   enp0s25      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
平均时间:    wlp2s0      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
平均时间:        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
[root@zabbix_nuc ~]#
1.
2.
3.
4.
5.
6.
7.
8.
9.
10.
11.
12.
13.
输出项说明：</p>
<h1 id="iface_1">IFACE 网卡名称</h1>
<h1 id="rxerrs">rxerr/s 每秒钟接收到的损坏的数据包</h1>
<h1 id="txerrs">txerr/s 每秒钟发送的数据包错误数</h1>
<h1 id="colls-collisions">coll/s 当发送数据包时候，每秒钟发生的冲撞（collisions）数，这个是在半双工模式下才有</h1>
<h1 id="rxdrops">rxdrop/s 当由于缓冲区满的时候，网卡设备接收端每秒钟丢掉的网络包的数目</h1>
<h1 id="txdrops">txdrop/s 当由于缓冲区满的时候，网络设备发送端每秒钟丢掉的网络包的数目</h1>
<h1 id="txcarrs">txcarr/s  当发送数据包的时候，每秒钟载波错误发生的次数</h1>
<h1 id="rxfram">rxfram   在接收数据包的时候，每秒钟发生的帧对其错误的次数</h1>
<h1 id="rxfifo">rxfifo    在接收数据包的时候，每秒钟缓冲区溢出的错误发生的次数</h1>
<h1 id="txfifo">txfifo    在发生数据包的时候，每秒钟缓冲区溢出的错误发生的次数</h1>
<p>1.
2.
3.
4.
5.
6.
7.
8.
9.
10.
11.
12.
13.
14.
15.
16.
17.
18.
19.
8.3、sar -n SOCK 1 1 #统计socket连接信息
[root@zabbix_nuc ~]# sar -n SOCK 1 1
Linux 3.10.0-693.17.1.el7.x86_64 (zabbix_nuc)   2018年03月29日     <em>x86_64</em>    (4 CPU)</p>
<p>11时09分42秒    totsck    tcpsck    udpsck    rawsck   ip-frag    tcp-tw
11时09分43秒       253         6         0         0         0       196
平均时间:          253         6         0         0         0       196
[root@zabbix_nuc ~]#
1.
2.
3.
4.
5.
6.
7.
输出项说明：</p>
<h1 id="totsck-socket">totsck 当前被使用的socket总数</h1>
<h1 id="tcpsck-tcpsocket">tcpsck 当前正在被使用的TCP的socket总数</h1>
<h1 id="udpsck-udpsocket">udpsck  当前正在被使用的UDP的socket总数</h1>
<h1 id="rawsck-rawskcket">rawsck 当前正在被使用于RAW的skcket总数</h1>
<h1 id="if-frag-ip">if-frag  当前的IP分片的数目</h1>
<h1 id="tcp-tw-tcptime-wait">tcp-tw TCP套接字中处于TIME-WAIT状态的连接数量</h1>
<p>如果你使用FULL关键字，相当于上述DEV、EDEV和SOCK三者的综合
1.
2.
3.
4.
5.
6.
7.
8.
9.
10.
11.
12.
13.
8.4、sar -n TCP 1 3 #TCP连接的统计
[root@zabbix_nuc ~]# sar -n TCP 1 3
Linux 3.10.0-693.17.1.el7.x86_64 (zabbix_nuc)   2018年03月29日     <em>x86_64</em>    (4 CPU)</p>
<p>11时11分28秒  active/s passive/s    iseg/s    oseg/s
11时11分29秒     25.00      2.00    134.00    138.00
11时11分30秒     29.00      2.00    153.00    159.00
11时11分31秒     27.00      2.00    143.00    149.00
平均时间:        27.00      2.00    143.33    148.67
[root@zabbix_nuc ~]#
1.
2.
3.
4.
5.
6.
7.
8.
9.
输出项说明：</p>
<h1 id="actives">active/s 新的主动连接</h1>
<h1 id="passives">passive/s 新的被动连接</h1>
<h1 id="isegs">iseg/s 接受的段</h1>
<h1 id="osegs">oseg/s 输出的段</h1>
<p>1.10.5：sar -n 使用总结
-n DEV ： 网络接口统计信息。
-n EDEV ： 网络接口错误。
-n IP ： IP数据报统计信息。
-n EIP ： IP错误统计信息。
-n TCP ： TCP统计信息。
-n ETCP ： TCP错误统计信息。
-n SOCK ： 套接字使用。
1.
2.
3.
4.
5.
6.
7.
8.
9.
10.
11.
12.
13.
14.
15.
16.
9、设备使用情况监控：
每5s采样一次，连续采样10次，报告设备使用情况
1.
[root@zabbix_nuc ~]# sar -d 5 10 -p
Linux 3.10.0-693.17.1.el7.x86_64 (zabbix_nuc)   2018年03月29日     <em>x86_64</em>    (4 CPU)</p>
<p>10时46分29秒       DEV       tps  rd_sec/s  wr_sec/s  avgrq-sz  avgqu-sz     await     svctm     %util
10时46分34秒       sda     13.60      0.00    486.40     35.76      0.29     21.43     18.01     24.50</p>
<p>10时46分34秒       DEV       tps  rd_sec/s  wr_sec/s  avgrq-sz  avgqu-sz     await     svctm     %util
10时46分39秒       sda     13.80      0.00    468.80     33.97      0.25     17.75     17.49     24.14</p>
<p>10时46分39秒       DEV       tps  rd_sec/s  wr_sec/s  avgrq-sz  avgqu-sz     await     svctm     %util
10时46分44秒       sda     47.60      0.00   3000.00     63.03      1.68     35.35     14.05     66.88</p>
<p>10时46分44秒       DEV       tps  rd_sec/s  wr_sec/s  avgrq-sz  avgqu-sz     await     svctm     %util
10时46分49秒       sda     36.40      0.00   2750.40     75.56      4.68    128.58     21.33     77.64</p>
<p>10时46分49秒       DEV       tps  rd_sec/s  wr_sec/s  avgrq-sz  avgqu-sz     await     svctm     %util
10时46分54秒       sda      7.80      0.00    177.60     22.77      0.74     60.08     66.23     51.66</p>
<p>10时46分54秒       DEV       tps  rd_sec/s  wr_sec/s  avgrq-sz  avgqu-sz     await     svctm     %util
10时46分59秒       sda      7.80      0.00    132.80     17.03      0.35     78.56     32.41     25.28</p>
<p>10时46分59秒       DEV       tps  rd_sec/s  wr_sec/s  avgrq-sz  avgqu-sz     await     svctm     %util
10时47分04秒       sda      8.80      0.00    177.60     20.18      0.33     37.45     24.84     21.86</p>
<p>10时47分04秒       DEV       tps  rd_sec/s  wr_sec/s  avgrq-sz  avgqu-sz     await     svctm     %util
10时47分09秒       sda      6.00      0.00    136.00     22.67      0.76    127.10     77.53     46.52</p>
<p>10时47分09秒       DEV       tps  rd_sec/s  wr_sec/s  avgrq-sz  avgqu-sz     await     svctm     %util
10时47分14秒       sda      6.20      0.00    129.60     20.90      0.80    125.74     80.55     49.94</p>
<p>10时47分14秒       DEV       tps  rd_sec/s  wr_sec/s  avgrq-sz  avgqu-sz     await     svctm     %util
10时47分19秒       sda      6.60      0.00    155.20     23.52      0.50     78.58     53.70     35.44</p>
<p>平均时间:          DEV       tps  rd_sec/s  wr_sec/s  avgrq-sz  avgqu-sz     await     svctm     %util
平均时间:          sda     15.46      0.00    761.44     49.25      1.04     67.08     27.42     42.39
[root@zabbix_nuc ~]#
1.
2.
3.
4.
5.
6.
7.
8.
9.
10.
11.
12.
13.
14.
15.
16.
17.
18.
19.
20.
21.
22.
23.
24.
25.
26.
27.
28.
29.
30.
31.
32.
33.
34.
35.
36.
参数
-p可以打印出sda,hdc等磁盘设备名称,如果不用参数-p,设备节点则有可能是dev8-0,dev22-0
1.
输出项说明：
tps:每秒从物理磁盘I/O的次数.多个逻辑请求会被合并为一个I/O磁盘请求,一次传输的大小是不确定的.</p>
<p>rd_sec/s:每秒读扇区的次数.</p>
<p>wr_sec/s:每秒写扇区的次数.</p>
<p>avgrq-sz:平均每次设备I/O操作的数据大小(扇区).</p>
<p>avgqu-sz:磁盘请求队列的平均长度.</p>
<p>await:从请求磁盘操作到系统完成处理,每次请求的平均消耗时间,包括请求队列等待时间,单位是毫秒(1秒=1000毫秒).</p>
<p>svctm:系统处理每次请求的平均时间,不包括在请求队列中消耗的时间.</p>
<p>%util:I/O请求占CPU的百分比,比率越大,说明越饱和.</p>
<ol>
<li>avgqu-sz的值较低时，设备的利用率较高。</li>
</ol>
<p>2.当%util的值接近 1%时，表示设备带宽已经占满</p>
              
            </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
